
\section{Introduction} \label{sec:introduction}

Today's autonomous vehicles are fitted with numerous on-board sensors and computers that make them suitable for many civilian and military applications. Complex capabilities like autonomous navigation, surveillance, mapping, and manipulations have transformed the uses of vehicles to improve our daily lives. 
%These new complex capabilities have transformed the uses of vehicles to improve our daily lives. 
With these new enhancements and capabilities, comes the risk of more security vulnerabilities to attacks and failures. An adversary can perform malicious attacks on sensor systems to degrade performance or completely hijack a vehicle to an undesired state. For example, authors in \cite{lee} demonstrated GPS spoofing to take over and change the route of a yacht in the middle of the sea.
%vehicle could be hijacked into an undesired region by spoofing its on-board GPS as demonstrated in \cite{lee}.

%For example, a vehicle could be hijacked into an undesired region by spoofing its on-board GPS as demonstrated in \cite{lee}.

%,6120187

Several different solutions have been proposed to address sensor attacks, from sensor redundancy to complex filtering techniques \cite{fawzi2014secure,6943080,7330811}. However, a solution for detecting malicious attacks on a system with an unknown model due to changes in dynamics or disturbances has yet to be proposed. This paper introduces a technique to detect sensor attacks on a dynamically changing system without losing control performance. We leverage an adaptive control algorithm to detect sensor under attacks and present an innovative adaptive planning framework to guarantee safety while the vehicle is navigating in an uncertain environment with changes in dynamics (e.g., due to a failure), disturbances (e.g., changes in surface material) and system's configuration (e.g., one or more sensors are removed after detecting that they are compromised). 
%along a trajectory with noisy sensor measurement data in an environment of undesired states. 
Our goal is to distinguish between malicious sensor attacks and dynamical changes or disturbances to the system. Once an attack is detected the system is operating without one or more sensors, hence it is not able to perform as originally designed.  Thus, the vehicle motion plan needs to be adapted based on the remaining available uncompromised sensors and their noise profiles. Adapting motion performance, like speed, ensures that the vehicle will always be safe (e.g., it will not enter undesired states). 

The contribution of this paper comes in two parts: 1) we design a technique to detect sensor attacks on an unknown, dynamically changing system, 2) after the compromised sensors have been removed, we propose a statistical-based motion replanning technique to take into account the new sensor configuration and  guarantee autonomous vehicle safety (i.e., something bad will never happen) and liveness (i.e., something good will eventually happen) while navigating in an obstacle filled environment using limited sensors with different noise profiles. 
To the best of our knowledge this is the first work that considers control and planning adaptation in the context of cyber-physical systems (CPS) security.

\subsection{Related Work}
\label{sec:Related Work}

The subject of both security and safety of autonomous vehicles has been gaining a lot of attention among the robotics  and controls communities due to their potential military and civilian implications.

Researchers have been looking into detection of malicious attacks and resilient state estimation to guarantee vehicle's safety considering different types of attacks and leveraging model based approaches \cite{zhu2012resilient, fawzi2014secure, 6943080, 7330811}. In all of these works, the goal is to prevent attackers from compromising system integrity, while keeping control performance, and safety. Numerous control and model based techniques have been recently leveraged for attack resilient state estimation. For example, in \cite{zhu2012resilient} a receding-horizon control algorithm is used to defend against replay attacks. Authors in \cite{8443718} propose a sliding window checkpointing protocol concept to recover states of a system as sensor attacks occur. Sensor redundancy based on a linear system model is leveraged in \cite{6943080} to build a recursive technique for state estimation and detect sensors attacks. In \cite{7330811}, authors leverage a linear system with sensor redundancy that guarantees a bounded estimation error resilient to attacks. Authors in \cite{fawzi2014secure} formally characterize an estimation technique proving that the number of sensor attacks has to be less than half in order to guarantee a correct estimation and resiliency against attacks. However, the aforementioned works and the majority of the literature on CPS cyber-security typically assume time invariant, static models where dynamics are not changing due to degradation, damage, and environmental or external factors. 
%\NB{we should have a couple of more papers here more recent on security? something from 2017/2018}

In this work, we build a framework to detect malicious sensor attacks on a dynamically changing system to protect its integrity and guarantee its stable and safe control. We use the theory of adaptive control to differentiate between sensor attacks and dynamical changes and ensure that control performance is not degraded while the system is dynamically changing over time. Several adaptive control algorithm have been introduced in the last few decades to deal with dynamically changing systems. In this paper we leverage the \textit{Characteristic Model-Based all-coefficient} (CMBAC) adaptive controller introduced in \cite{4106038}, where the authors demonstrate its advantages (e.g., simple to use and robust in nature), modeling steps, and many applications. An example CMBAC application is presented in \cite{7578288}, in which a quadrotor attitude control is adapted and the results are compared with a conventional Proportional-Integral-Derivative (PID) controller. In \cite{Di2014}, CMBAC is leveraged to control an active magnetic bearing (AMB) consisting of nonlinear dynamics and uncertainties, showing its simple structure and strong performance in comparison to other controllers. Different from previous work, here we propose to use adaptive control to detect sensor attacks on systems experiencing changing dynamics while maintaining control performance.



%The CMBAC technique is an efficient option due to the simplicity of the number of parameters to estimate. A discrete-time approach to the CMBAC is utilized to achieve our control objectives.



When uncertainties arise or dynamical changes occur, adaptation is needed not only at the control level but also at the planning level in order to guarantee safety. Several work on this area use prediction to re-plan the operation of a system and avoid unsafe states. In \cite{8463205}, reachability analysis leveraging the system model and uncertainties is used to determine inputs to avoid unsafe states like a collision with an obstacle. In \cite{5980508}, Random-Belief Trees are created to guarantee safety in uncertain environments for safe navigation. The work in \cite{6934041} presents a Risky Area with the help of probability density functions to prevent vehicle collisions. In our work we propose a novel statistical-based approach to adapt the vehicle's motion when needed and obtain more data to improve its state estimation confidence.

The rest of the paper is organized as follows: in section \ref{sec:problem}, we formally define the problems at hand and in section \ref{sec:modeling}, we define all system, noise, and disturbance models. In section \ref{sec:approach}, we discuss our adaptive control-based approach for attack detection and the adaptive planning navigation technique to deal with limited resources after removing an attack. Validation with simulations for an autonomous vehicle case study are presented in Section \ref{sec:simulation}. Lastly, we draw conclusions and discuss future work in Section \ref{sec:conclusion}.


